# Mazeon 仕様書 v0.1

最終更新: 2025-08-27

## 1. ゲーム概要
- タイトル: Mazeon
- ジャンル: 協力型リアルタイム迷路探索
- 目的: 制限時間内に鍵を集め、全員で出口到達/脱出
- 対象: iOS / Android（React Native）、バックエンドは Node.js（Express + Socket.IO）

## 2. 基本仕様
- プレイ人数: 1〜8人（オンライン協力）
- 制限時間: 15分（難易度で可変）
- 迷路: 自動生成（乱数生成）
- マップサイズ: 200 × 200（セル）
- 階層数: 最大3階層（難易度によって決定）
  - EASY: 1階層
  - NORMAL: 2階層
  - HARD: 3階層
- 主要アイテム: 鍵、照明装置（フレア/ビーコン）、バフ系（速度/視界）、デバフ/罠
- リスポーン: なし（気絶/救助などは別途拡張検討）

## 3. キャラクター（クラス）
画像に基づく特性/強み/弱みを反映。数値は初期提案（1〜5の段階値）で、ゲームバランス調整の基準とする。

| キャラ名 | 役割/特徴 | 強み | 弱み | 速度 | 視界 | 体力 | 戦闘 | 運搬 | 罠解除 | 魔力 |
|---|---|---|---|---:|---:|---:|---:|---:|---:|---:|
| 斥候 | 足が速く、視界範囲が広い | 先行探索が得意 | 体力が低い、罠解除不可 | 5 | 5 | 2 | 2 | 2 | 1 | 1 |
| 魔法使い | 壁破壊や暗闇を照らす魔法 | 障害物をショートカット可能 | 魔力ゲージが必要、移動が遅い | 2 | 3 | 3 | 3 | 2 | 1 | 5 |
| 工作員 | 罠解除・扉開錠が得意 | チームの安全確保 | 攻撃力低い、探索速度遅い | 3 | 3 | 3 | 2 | 3 | 5 | 1 |
| 運搬役 | 一度に多くのアイテムを持てる | 脱出アイテム運搬効率UP | 移動が遅い | 2 | 3 | 4 | 2 | 5 | 2 | 1 |
| 照明係 | 広範囲を一時的に明るくする装置を持つ | 視界サポート | 戦闘力が低い | 3 | 4 | 3 | 1 | 3 | 2 | 2 |

- メモ
  - 「視界」はミニマップ/視野円の半径係数。
  - 「運搬」は同時所持スロット/重量補正。
  - 「罠解除」は解除成功率・解除時間短縮係数。
  - 「魔力」は魔法使用回数/回復レートに関与。

### 3.1 クラス固有アクティブ/パッシブ（初期案）
- 斥候: スプリント（短時間速度+1段階）, 偵察マーク（近傍の鍵/出口方向を短時間表示）
- 魔法使い: ライト（周囲照明）, フェイズ（薄壁を通過/壁破壊）
- 工作員: ディスアーム（罠解除）, ピッキング（扉開錠/開錠時間短縮）
- 運搬役: パックラット（所持枠+N）, バックパック共有（近接味方と受け渡し高速化）
- 照明係: フレア（一定半径を明るく）, ビーコン（一定時間、灯台効果+ミニマップ共有）

## 4. ゲームルール
1. ルーム作成/参加 → ロビーで人数が揃い次第開始
2. 迷路は乱数生成される（ゲームごとにレイアウトが異なる）
3. マップの広さは 200 × 200（セル）で固定
4. ゴール解放には、マップ内に落ちている「3つの鍵」の回収が必要
5. マップにはお助けアイテム（照明/速度強化/妨害無効など）が配置される
6. 階層数は難易度で決定（EASY:1、NORMAL:2、HARD:3）
7. 全鍵回収後、出口が解放 → 指定人数が出口到達でクリア
8. 時間切れ、全滅、致命的条件で失敗

## 5. 画面/UX（既存実装準拠）
- HomeScreen: ルーム作成（人数/迷路サイズ/階層/制限時間）・参加（ID）
- LobbyScreen: 参加者表示/ホストのみ開始・基本設定の確認
- GameScreen: 迷路UI、移動コントロール、タイマー、所持品/鍵状態、伝説（凡例）

## 6. 操作
- 移動: 十字/スワイプ/ボタン
- インタラクト: 近接で自動/ボタン長押し（扉/罠/アイテム）
- クラススキル: 2スロット（アクティブ/パッシブ）想定

## 7. システム/データ仕様（抜粋）
- 難易度プリセット（階層定義）
  - EASY: 1階層（200×200）
  - NORMAL: 2階層（各階 200×200）
  - HARD: 3階層（各階 200×200）
- アイテム
  - 鍵: 3本。全回収で出口が解放。UIに所持状況を表示
  - 照明装置: 一時的に視界を拡張（照明係は効果範囲/持続増）
  - 罠: 速度低下/視界低下など。工作員の解除対象

## 8. ネットワーク（イベント概要）
- ルーム: `createRoom`, `joinRoom`, `leaveRoom`, `rooms`
- ゲーム: `startGame`, `setGameState`, `movePlayer`, `keyCollected`, `gameWon`
- 接続: `connect`, `disconnect`, `reconnect`
- すべてのイベント名/ペイロードは `src/constants/GameConstants.js` の契約/命名に準拠（拡張時は同ファイルに追記）

## 9. バランス調整パラメータ（参考）
- 速度係数: 斥候5 > 照明3 > 工作員/運搬2-3 > 魔法2
- 視界係数: 斥候5 > 照明4 > 魔法/工作/運搬3
- 魔力回復: 1.0/sec（装備/アイテムで補正）
- 罠解除時間: 基本3.0s（工作員は-50%）
- 運搬容量: 基本2枠（運搬役+3枠）

## 10. アセット/UI指針
- 画像/音声は `src/assets/*` の命名規約/READMEに準拠
- UI配色/タイポは `GameConfig.ui` を基準に統一
- 多言語は `GameConfig.Localization` に追記

## 11. テスト/QA
- 主要ロジック（移動/罠解除/鍵回収/タイマー）はユニットテスト対象
- 低性能端末での60fps目標、長時間プレイでのリーク/発熱チェック

## 12. 参照
- 設定: `src/config/GameConfig.js`
- 定数: `src/constants/GameConstants.js`
- 共通関数: `src/utils/GameUtils.js`
- 画面: `src/screens/*`
- バックエンド: `backend/server.js`

> 本仕様は初期案です。実装に伴い数値/挙動は `GameConfig`/`GameConstants` に即して調整します。