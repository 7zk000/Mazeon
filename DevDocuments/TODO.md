# TODO（開発タスクリスト）

最終更新: 2025-08-27

本TODOは Mazeon の実装タスクを俯瞰する一覧です。完了時はチェックを入れ、必要に応じて受け入れ条件（AC）に従って確認してください。

## 0. 仕様反映（ゲームルール）
- [ ] マップサイズ 200×200 を実装（全階層共通）
- [ ] 最大3階層（EASY:1 / NORMAL:2 / HARD:3）を実装
- [ ] 3本の鍵配置と出口解放条件（鍵全回収で解放）を実装
- [ ] お助けアイテム（照明/速度等）のスポーンと効果を実装

AC: 乱数生成された各階層に鍵3本が置かれ、全回収後に出口が解放される。階層数は難易度で切替。200×200を満たす。

---

## 1. バックエンド（Node.js / Socket.IO）
- [ ] 迷路生成のパラメータ化（200×200、階層数）
- [ ] 鍵3本の配置ロジックと重複/到達不能チェック
- [ ] 出口解放イベント（keys=3 → `game:exit:open` 等）を追加
- [ ] お助けアイテムの種類・効果・スポーンルール定義
- [ ] ルーム状態に鍵数/階層/アイテム情報を含め配信
- [ ] 再接続時の状態リカバリ（鍵・階層・タイマー）

AC: API/Socketイベントが `src/constants/GameConstants.js` と整合し、負荷試験で安定。再接続で完全復元。

---

## 2. フロントエンド（React Native）
- [ ] GameScreen に鍵カウンタ(3/3)・階層表示・出口状態をUI追加
- [ ] 200×200描画最適化（バーチャル化/縮尺・迷路タイル最適表示）
- [ ] お助けアイテムUI/効果（照明/速度ブースト等）
- [ ] `GameContext` に鍵/出口/階層/アイテムの状態同期を追加
- [ ] `GameConfig`/`GameConstants` に新ルール用定数を追記
- [ ] 低性能端末向け描画負荷低減（reanimated/メモ化）

AC: 60fpsを目標にカクつきがない。鍵/出口/階層がリアルタイム同期しUIに正しく反映。

---

## 3. 共有/ドメイン（定数・設定・ユーティリティ）
- [ ] `GameConstants` にイベント名・状態・難易度定義を拡張
- [ ] `GameConfig` にマップ/階層/鍵/アイテム設定を追加
- [ ] 乱数/配置ユーティリティ（到達可能性の検証関数）

AC: 両端で単一の契約に基づき動作。重複定数なし。

---

## 4. QA/テスト/パフォーマンス
- [ ] 鍵配置・出口解放のユニット/結合テスト
- [ ] 階層遷移（1→2→3）と状態維持テスト
- [ ] 200×200描画時のFPS/メモリ/バッテリー計測
- [ ] 切断/再接続・ホスト交代時の復元テスト

AC: CIで主要テストがパスし、実機で60fps近傍、長時間でリークなし。

---

## 5. ドキュメント/運用
- [ ] `README.md` にゲームルール（3鍵/200×200/階層）要約を追記
- [ ] `setup.md` に開発時の推奨デバイス/実機手順追記
- [ ] `DevDocuments/仕様書.md` の改訂履歴更新
- [ ] 変更に伴うスクリーンショット/図の追加（任意）

AC: 新規開発者がドキュメントのみでセットアップ/動作確認可能。

---

## 6. 追加（任意・将来）
- [ ] クラス固有スキルの実装（斥候/魔法使い/工作員/運搬役/照明係）
- [ ] 視界/暗闇・光源システムの高度化（影・減衰）
- [ ] ランク/ハイスコア・実績連携
- [ ] データ永続化（MongoDB 等）と観戦モード

---

### 運用ルール
- 変更が定数/設定/イベント契約に影響する場合は、`GameConstants`/`GameConfig` を先に更新し、フロント/バック双方で参照。
- 重複実装禁止。既存 `config/constants/utils/services/hooks/components` を優先再利用。
- 完了時はACに基づき自己検証→PR。必要なら仕様書へ反映。
